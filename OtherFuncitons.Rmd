---
title: "OtherFunctions"
output: pdf_document
date: "2025-03-04"
---
```{r}
data(iris)
attach(iris)

## classification mode
# default with factor response:
model <- svm(Species ~ ., data = iris)

# alternatively the traditional interface:
x <- subset(iris, select = -Species)
y <- Species
model <- svm(x, y) 

print(model)
summary(model)

# test with train data
pred <- predict(model, x)
# (same as:)
pred <- fitted(model)

```

```{r setup, include=FALSE}
library(caret)
install.packages("ROSE")
library(ROSE)
install.packages("caTools")
library(caTools)
install.packages("pROC")
library(pROC)
set.seed(300)
library(ggplot2)
install.packages("kknn")
library(kknn)
# Ensure necessary libraries are installed
if (!require(ggplot2)) install.packages("ggplot2", dependencies=TRUE)
# Load ggplot2
library(ggplot2)

load(file="~/NNS.RData")
load(file="~/Annotation.RData")

z_score <- z_score_cluster[,-17]
annotation <- totalLabels[, c("PMA", "po_br")]
z_score$label <- totalLabels$po_br/(totalLabels$po_br + totalLabels$ng_og +
                                      0.0001)

z_score$category <- unlist(lapply(z_score$label, function(x) if(x > 0) {1} else {0})) # 0.5
data <- z_score[,-17]
data$category <- z_score$category
data$category2 <- factor(data$category)
levels(data$category2) <- make.names(levels(data$category2))
```

```{r}
data$category <- as.factor(data$category)
split = caTools::sample.split(data$category, 
                     SplitRatio = 0.75) # 0.75
train = subset(data, 
               split == TRUE)
test = subset(data, 
              split == FALSE)
# resample positive as the same number as negative
over <- ROSE::ovun.sample(category~., data = train, method = "over", 
                          N = dim(train[train$category==0,])[[1]] * 2)$data

```

```{r}
library(e1071)
#model <- svm(category ~ ., data = train[, -18], kernel = "radial", cost = 1, gamma = 0.5, class.weights = c("0" = 1, "1" = 3))

model <- svm(category ~ ., data = over[, -18], class.weights = c("0" = 1, "1" = 2))
pred <- predict(model, test[, -c(17,18)])
confusion <- confusionMatrix(pred, test$category, positive = "1")
plot(cmdscale(dist(data[, -c(17,18)])),
     col = as.integer(data$category),
     pch = c("o","+")[1:150 %in% model$index + 1])


```
```{r}
# Ensure necessary libraries are installed
if (!require(ggplot2)) install.packages("ggplot2", dependencies=TRUE)

# Load ggplot2
library(ggplot2)

data$PMA <- annotation$PMA
# Filter the data
filtered_data <- data[data$PMA > 221 & data$category == 0, ]

# Filter the data
filtered_data <- data[data$PMA > 221 & data$category == 0, ]$PMA

# Plot histogram using ggplot2
ggplot(data.frame(PMA = filtered_data), aes(x = PMA)) +
  geom_histogram(binwidth = 10, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histogram of PMA (PMA > 221 & category == 0)",
       x = "PMA",
       y = "Count") +
  theme_minimal()
```
```{r}
filtered_data <- data[data$PMA > 221 & data$category == 1, ]$PMA

# Plot histogram using ggplot2
ggplot(data.frame(PMA = filtered_data), aes(x = PMA)) +
  geom_histogram(binwidth = 10, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histogram of PMA (PMA > 221 & category == 0)",
       x = "PMA",
       y = "Count") +
  theme_minimal()
```



```{r}
model <- svm(category ~ ., data = train_data, kernel = "polynomial", degree = 3)
```


## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
